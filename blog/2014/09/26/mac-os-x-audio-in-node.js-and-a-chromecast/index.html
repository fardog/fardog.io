<!doctype html><html lang=en-us><head><title>Mac OS X Audio in node.js, and a Chromecast | fardog.io</title>
<meta name=generator content="Hugo 0.128.0"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="dark light"><meta name=author content="Nathan Wittstock"><meta name=description content="A few weeks ago, a simple idea formed: why can&rsquo;t you easily stream system audio to a Chromecast? Sure, if your chosen listening application already supports it, you&rsquo;re set. Otherwise you&rsquo;re left out.
A solution seemed simple: node.js has streams, and they&rsquo;re awesome! Take system audio, pipe it to an encoder, pipe that to an HTTP response, and tell the Chromecast where to look. Easy!
Except, there&rsquo;s no node.js package that supports OS X audio input, except via bindings to another library."><meta name=referrer content="no-referrer"><link rel=canonical href=https://fardog.io/blog/2014/09/26/mac-os-x-audio-in-node.js-and-a-chromecast/><link rel="shortcut icon" type=image/vnd.microsoft.icon href=/favicon.ico><link rel=stylesheet href=/main.min.9637009c6b01416517e2b0e76a0530c7038e1c72499cd53ae621955c3631a6f5a07d4c5b7de66c4c27dfa27d92de278cc57ac5e5994409027ddc733b09dec622.css integrity="sha512-ljcAnGsBQWUX4rDnagUwxwOOHHJJnNU65iGVXDYxpvWgfUxbfeZsTCffon2S3ieMxXrF5ZlECQJ93HM7Cd7GIg=="><meta itemprop=name content="Mac OS X Audio in node.js, and a Chromecast"><meta itemprop=description content="A few weeks ago, a simple idea formed: why can’t you easily stream system audio to a Chromecast? Sure, if your chosen listening application already supports it, you’re set. Otherwise you’re left out.
A solution seemed simple: node.js has streams, and they’re awesome! Take system audio, pipe it to an encoder, pipe that to an HTTP response, and tell the Chromecast where to look. Easy!
Except, there’s no node.js package that supports OS X audio input, except via bindings to another library."><meta itemprop=datePublished content="2014-09-26T12:05:00-07:00"><meta itemprop=dateModified content="2014-09-26T12:05:00-07:00"><meta itemprop=wordCount content="485"><meta itemprop=keywords content="Code,Javascript,Projects,Node.js"><meta property="og:url" content="https://fardog.io/blog/2014/09/26/mac-os-x-audio-in-node.js-and-a-chromecast/"><meta property="og:site_name" content="fardog.io"><meta property="og:title" content="Mac OS X Audio in node.js, and a Chromecast"><meta property="og:description" content="A few weeks ago, a simple idea formed: why can’t you easily stream system audio to a Chromecast? Sure, if your chosen listening application already supports it, you’re set. Otherwise you’re left out.
A solution seemed simple: node.js has streams, and they’re awesome! Take system audio, pipe it to an encoder, pipe that to an HTTP response, and tell the Chromecast where to look. Easy!
Except, there’s no node.js package that supports OS X audio input, except via bindings to another library."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2014-09-26T12:05:00-07:00"><meta property="article:modified_time" content="2014-09-26T12:05:00-07:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Mac OS X Audio in node.js, and a Chromecast"><meta name=twitter:description content="A few weeks ago, a simple idea formed: why can’t you easily stream system audio to a Chromecast? Sure, if your chosen listening application already supports it, you’re set. Otherwise you’re left out.
A solution seemed simple: node.js has streams, and they’re awesome! Take system audio, pipe it to an encoder, pipe that to an HTTP response, and tell the Chromecast where to look. Easy!
Except, there’s no node.js package that supports OS X audio input, except via bindings to another library."></head><body><header><nav><a title="Return to Blog" href=/blog/>&larr; Blog</a></nav><h1>Mac OS X Audio in node.js, and a Chromecast</h1></header><main><p>A few weeks ago, a simple idea formed: why can&rsquo;t you easily stream system audio to a Chromecast? Sure, if your chosen listening application already supports it, you&rsquo;re set. Otherwise you&rsquo;re left out.</p><p>A solution seemed simple: node.js has <a href=http://nodejs.org/api/stream.html>streams</a>, and they&rsquo;re awesome! Take system audio, pipe it to an encoder, pipe that to an HTTP response, and tell the Chromecast where to look. Easy!</p><p>Except, there&rsquo;s no node.js package that supports OS X audio input, except via <a href=https://www.npmjs.org/package/node-core-audio>bindings to another library</a>. I wanted to write something that was only dependent on the OS X core frameworks.</p><h2 id=hello-osx-audioosx-audio>Hello <a href=https://www.npmjs.org/package/osx-audio>osx-audio</a></h2><p>A few weeks later, and there&rsquo;s a solution (writing your first node.js native binding is hard!). <a href=https://www.npmjs.org/package/osx-audio>osx-audio</a> will allow you to get a readable stream from your currently-selected OS X audio input. It only depends on the frameworks available in Mac OS X, so if you can compile any other native node.js extension, you should be able to install it!</p><p>You should check it out if audio input&rsquo;s the thing you need. Output will be implemented in the future too!</p><h2 id=how-about-the-chromecast>How about the Chromecast?</h2><p><a href=https://www.npmjs.org/package/chromecast-osx-audio>Solved</a>, but it still requires an additional piece of software. You see, OS X doesn&rsquo;t provide native methods for accessing system audio (the output of the system mixer) so anything that&rsquo;s not an input (like the microphone) is inaccessible. However, there&rsquo;s a open source utility called <a href=http://rogueamoeba.com/freebies/soundflower/>Soundflower</a> that solves this for you. If you&rsquo;re unfamiliar with it, here&rsquo;s a step by step to get it working:</p><ol><li>Install <a href=http://rogueamoeba.com/freebies/soundflower/>Soundflower</a>. Reboot.</li><li>Install <a href=https://www.npmjs.org/package/chromecast-osx-audio>chromecast-osx-audio</a> globally, with an <code>npm install -g chromecast-osx-audio</code></li><li>Open your <em>System Preferences -> Sound</em> preference pane, and select &ldquo;Soundflower (2ch)&rdquo; as both your input and output.</li><li>Run <code>chromecast</code> in your terminal. It will find the first-available Chromecast, and stream your system audio to it.</li><li>Play your music/audio as normal. There is a 5–15 second delay due to how the Chromecast buffers.</li><li>Enjoy</li></ol><h2 id=ok-great-i-dont-have-a-chromecast>Ok, great. I don&rsquo;t have a Chromecast</h2><p>They are pretty cheap! But, I wrote a generic module that just exposes a live mp3 stream of your system audio. It&rsquo;s called <a href=https://www.npmjs.org/package/webcast-osx-audio>webcast-osx-audio</a>, and it&rsquo;s what <a href=https://www.npmjs.org/package/chromecast-osx-audio>chromecast-osx-audio</a> relies on for it&rsquo;s streaming component. You can install it just as above, and it exposes a <code>webcast-audio</code> command when installed globally. Connect to <em>http://your_local_ip:3000/stream.mp3</em> and you&rsquo;re good to go!</p><h2 id=whats-next>What&rsquo;s next?</h2><ul><li>I still need to write the input-side output-side of <a href=https://www.npmjs.org/package/osx-audio>osx-audio</a> before I consider it complete. And tests!</li><li><a href=https://www.npmjs.org/package/chromecast-osx-audio>chromecast-osx-audio</a> will only stream to the first Chromecast it finds. I plan to implement an interface that allows you to select which you&rsquo;d like to stream to if multiple are found. That&rsquo;ll be in before v1.0.</li></ul><p>Note that both modules command-line interfaces have usage information! Just run <code>chromecast --help</code> or <code>webcast-audio --help</code> to see what options are available!</p><p><em>Note: What we go through to solve problems, eh? All of this still assumes some familiarity with node.js—this is definitely not a solution for the non-technical. Maybe someday!</em></p></main><footer role=contentinfo>© 2024 Nathan Wittstock
—
Content: <a href=https://creativecommons.org/licenses/by/4.0/ target=_blank>CC BY 4.0</a>,
Code: <a href=https://github.com/fardog/fardog.io/blob/master/LICENSE target=_blank>MIT</a>, unless otherwise noted.<p class="f6 fw6 pv0 mv2">View the
<a href=https://github.com/fardog/fardog.io/ target=_blank>source</a>
for this site.
<a href=https://fardog.io/privacy/>Privacy</a>.</p></footer></body></html>